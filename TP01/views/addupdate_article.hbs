<h2 class="text-center text-dark my-5">Créer un article</h2>

<section class="container">
  <form action="/addupdate_article" method="post" enctype="application/x-www-form-urlencoded">
    <input
      class="form-control form-control-lg mb-2"
      type="text"
      placeholder="Titre de l'article"
      name="title"
    />

    <input
      class="form-control form-control-sm mb-2"
      type="text"
      placeholder="Auteur de l'article"
      name="author"
    />

    <textarea
      class="form-control mb-2"
      rows="10"
      placeholder="Contenu de l'article"
      name="content"
    ></textarea>

    <div class="mt-3 w-50 custom-file">
      <input
        accept="image/*"
        type="file"
        name="formFile"
        id="formFile"
        class="form-control custom-file-input"
        value=""
        onchange="previewPicture(this)"
        accept=".jpg, .jpeg, .png"
      />
      <label for="formFile" class="custom-file-label"></label>
      <img id="preview" class="mt-3 w-25 img-fluid" />
    </div>

    <div class="col-lg col-lg-offset text-center">
      <button type="submit" class="btn btn-outline-dark">Envoyer</button>
    </div>
  </form>
</section>

<script type="text/javascript" >
    // L'image img#image
    let image = document.getElementById("formFile");

    // La fonction previewPicture
    let previewPicture  = function (e) {

        // e.files contient un objet FileList
        const [formFile] = e.files

        // Les types de fichier autorisés
        const types = [ "image/jpg", "image/jpeg", "image/png" ];

        // Vérification si "picture.type" se trouve dans "types"
        if (types.includes(formFile.type)) {

            // L'objet FileReader
            let reader = new FileReader();

            // L'événement déclenché lorsque la lecture est complète
            reader.onload = function (e) {
                // On change l'URL de l'image (base64)
                image.src = e.target.result
            }

            // On lit le fichier "picture" uploadé
            reader.readAsDataURL(formFile)

        }
    }
</script>